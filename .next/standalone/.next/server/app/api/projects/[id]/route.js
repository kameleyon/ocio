"use strict";(()=>{var e={};e.id=361,e.ids=[361],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},8892:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>m,originalPathname:()=>g,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>j,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>q});var o={};t.r(o),t.d(o,{DELETE:()=>l,GET:()=>d,PUT:()=>p});var s=t(5419),i=t(9108),n=t(9678),a=t(8070),u=t(1664),c=t(2455);async function d(e,{params:r}){(0,c.cookies)();let t=(0,u.e)();try{let{data:{session:e}}=await t.auth.getSession();if(!e)return a.Z.json({error:"Unauthorized"},{status:401});let o=r.id,{data:s,error:i}=await t.from("projects").select("*").eq("id",o).eq("user_id",e.user.id).single();if(i){if("PGRST116"===i.code)return a.Z.json({error:"Project not found"},{status:404});throw i}return a.Z.json(s)}catch(e){return console.error("Error fetching project:",e),a.Z.json({error:"Internal server error"},{status:500})}}async function p(e,{params:r}){(0,c.cookies)();let t=(0,u.e)();try{let{data:{session:o}}=await t.auth.getSession();if(!o)return a.Z.json({error:"Unauthorized"},{status:401});let s=r.id,{data:i,error:n}=await t.from("projects").select("id, user_id").eq("id",s).eq("user_id",o.user.id).single();if(n){if("PGRST116"===n.code)return a.Z.json({error:"Project not found"},{status:404});throw n}let u=await e.json(),c=["name","description","tech_stack"],d=Object.keys(u).filter(e=>c.includes(e)).reduce((e,r)=>(e[r]=u[r],e),{}),{data:p,error:l}=await t.from("projects").update(d).eq("id",s).select().single();if(l)throw l;return a.Z.json(p)}catch(e){return console.error("Error updating project:",e),a.Z.json({error:"Internal server error"},{status:500})}}async function l(e,{params:r}){(0,c.cookies)();let t=(0,u.e)();try{let{data:{session:e}}=await t.auth.getSession();if(!e)return a.Z.json({error:"Unauthorized"},{status:401});let o=r.id,{data:s,error:i}=await t.from("projects").select("id, user_id").eq("id",o).eq("user_id",e.user.id).single();if(i){if("PGRST116"===i.code)return a.Z.json({error:"Project not found"},{status:404});throw i}let{data:n}=await t.storage.from("project-files").list(`project-zips/${o}`);if(n&&n.length>0){let e=n.map(e=>`project-zips/${o}/${e.name}`);await t.storage.from("project-files").remove(e)}let{error:u}=await t.from("projects").delete().eq("id",o);if(u)throw u;return a.Z.json({success:!0})}catch(e){return console.error("Error deleting project:",e),a.Z.json({error:"Internal server error"},{status:500})}}let j=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/projects/[id]/route",pathname:"/api/projects/[id]",filename:"route",bundlePath:"app/api/projects/[id]/route"},resolvedPagePath:"C:\\Users\\Administrator\\myAPP\\ocioweb\\app\\api\\projects\\[id]\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:x,headerHooks:m,staticGenerationBailout:q}=j,g="/api/projects/[id]/route";function v(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},1664:(e,r,t)=>{t.d(r,{e:()=>i});var o=t(6874),s=t(2455);function i(){let e=(0,s.cookies)();return(0,o.lx)(process.env.SUPABASE_URL,process.env.SUPABASE_ANON_KEY,{cookies:{get:r=>e.get(r)?.value,set(r,t,o){e.set({name:r,value:t,...o})},remove(r,t){e.set({name:r,value:"",...t})}}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[225,542],()=>t(8892));module.exports=o})();